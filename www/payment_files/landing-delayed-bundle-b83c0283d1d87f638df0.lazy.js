webpackJsonp([21],{549:function(e,exports,t){(function($,i){"use strict";var n=t(550),a=t(552),o=t(555),r=t(99),s=t(470),d=t(11),c=t(9),l=function(){function e(){this._modalService=new r}return e.prototype.init=function(e,t,i,n){this._chatInfo=n,this._initState(e,t,i),this._remainingTime=e,this._leaveTimestamp=(new Date).getTime(),this.subscribeToKnockoutEvent(),this._subscribeToIdleTimer(),this._subscribeToWindowLeave(),this._subscribeToWindowEnter()},e.prototype.reset=function(){$(document).idleTimer("destroy"),$(document).off("idle.idleTimer")},e.prototype._subscribeToWindowLeave=function(){var e=this;$(window).blur(function(){$(document).idleTimer("isIdle")?e._remainingTime=$(document).idleTimer("getRemainingTime"):e.idleState()===s.Initial?e._isIdleChatEnabled()&&!e._isChatInitiated?e._remainingTime=e._idleChatTimeout:e._remainingTime=e._idleWarningTimeout:e._remainingTime=e.idleTimeout,e._leaveTimestamp=(new Date).getTime(),$(document).idleTimer("destroy")})},e.prototype._subscribeToWindowEnter=function(){var e=this;$(window).focus(function(){e._remainingTime-=(new Date).getTime()-e._leaveTimestamp,e._remainingTime>0?e.idleState()===s.Initial?e._isIdleChatEnabled()&&!e._isChatInitiated?e.createTimer(e._idleChatTimeout):e.createTimer(e._idleWarningTimeout):e.createTimer(e.idleTimeout):(e.idleState()!==s.Initial||e._isIdleChatEnabled()&&!e._isChatInitiated||(e._remainingTime+=e.idleTimeout,e._remainingTime<=0&&e.idleState(s.Warning)),$(document).trigger($.Event("idle.idleTimer")))})},e.prototype._initState=function(e,t,n){var a=this;this._idleWarningTimeout=e,this.idleTimeout=t,this._idleTimeoutAfterSubmitBooking=n,this.idleState=i.observable(s.Initial);var o=e;this._isIdleChatEnabled()&&(this._idleChatTimeout=this._chatInfo.idleTimeoutToDisplayChat(),o=this._idleChatTimeout),this.getModal().then(function(e){a._idleWarningModal=e,a.createTimer(o)})},e.prototype._isIdleChatEnabled=function(){return!!this._chatInfo},e.prototype._launchChat=function(){o.LaunchChat(this._chatInfo),this._isChatInitiated=!0,this._leaveTimestamp=(new Date).getTime(),this.createTimer(this._idleWarningTimeout)},e.prototype._subscribeToIdleTimer=function(){var e=this;$(document).on("idle.idleTimer",function(t,i){switch($(document).idleTimer("destroy"),e.idleState()){case s.Initial:if(e._isIdleChatEnabled()&&!e._isChatInitiated){e._launchChat();break}e.idleState(s.Warning);var n=new a(e._idleWarningModal);e._modalService.open(n,!0),e.createTimer(e.idleTimeout);break;case s.Warning:case s.Submitted:e.idleState(s.Timeout),e.getModal().then(function(t){if(t){var i=e.createIdleTimeoutModalBindingOptions(t);e._modalService.open(i,!0)}});break;case s.WechatPayPending:}})},e.prototype.createIdleTimeoutModalBindingOptions=function(e){return new n(e)},e.prototype.subscribeToKnockoutEvent=function(){var e=this;i.postbox.subscribe(d.RESET_IDLE_TIMER,function(t){switch(e.idleState(t),t){case s.Submitting:$(document).idleTimer("pause");break;case s.Submitted:$(document).idleTimer("destroy"),e.createTimer(e._idleTimeoutAfterSubmitBooking);break;case s.WechatPayPending:$(document).idleTimer("destroy");break;default:$(document).idleTimer("destroy"),e.createTimer(e._idleWarningTimeout)}})},e.prototype.createTimer=function(e){$.idleTimer({idle:!1,timeout:e}),this._remainingTime=$(document).idleTimer("getRemainingTime")},e.prototype.getModal=function(){var e=$.Deferred();return this.idleState()!==s.Initial?e.resolve(c.getPageData().jsonViewModel.idleTimeoutModal):e.resolve(c.getPageData().jsonViewModel.idleWarningModal),e.promise()},e}();e.exports=l}).call(exports,t(2),t(3))},550:function(e,exports,t){(function(i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},a=t(97),o=t(96),r=function(e){function a(n){e.call(this),this.header.data={isCloseBtnDisplayed:!1,title:n.title},this.body.name=o.IDLE_TIMEOUT_MODAL_BODY,i.stringTemplateEngine.instance.addTemplate(this.body.name,t(551)),this.body.data=n,this.dialogCss=o.IDLE_TIMEOUT_MODAL_CLASS,this.options.backdrop="static"}return n(a,e),a}(a);e.exports=r}).call(exports,t(3))},551:function(e,exports){e.exports='<div class=text-center> <span data-bind="text: youCanEitherReturnToHotelPageOrSearchHotelsInXText"></span> </div> <div class=row> <div class=col-sm-6> <div class="image hotel-placeholder-image m-t-2 m-b-2"> <div class=hotel-image data-bind="style: {backgroundImage: \'url(\\\'\' + hotelImageUrl +\'\\\')\'}"></div> </div> <a class="btn btn-primary btn-block btn-word-wrap redirect-to-hotel-btn" href=# target=_self role=button data-bind="html: redirectToHotelPageBtnText, attr: { href: hotelPageUrl }, matchHeight: { targetElement: \'.idle-timeout-modal .redirect-to-search-result-btn\', delayMS: 200 }"></a> </div> <div class=col-sm-6> <div class="image city-placeholder-image m-t-2 m-b-2"> <div class=city-image data-bind="style: {backgroundImage: \'url(\\\'\' + cityImageUrl +\'\\\')\'}"></div> </div> <a class="btn btn-primary btn-block btn-word-wrap redirect-to-search-result-btn" href=# target=_self role=button data-bind="html: redirectToSearchResultPageBtnText, attr: { href: searchResultPageUrl }"></a> </div> </div> <div class=divider-solid-bottom></div> <div class=row> <div class=col-sm-12> <div class=text-center> <a href=# target=_self data-bind="click: function(){window.location.reload();}"> <i class="ficon ficon-18 ficon-refresh refresh-icon"></i> <span class=reload-my-booking-page data-bind="html:reloadMyBookingPageText, matchHeight: { targetElement: \'.idle-timeout-modal .redirect-to-search-result-btn\', delayMS: 200 }"></span> </a> </div>  <div class=text-center> <span class=prices-and-availability data-bind="text: priceAndRoomAvailabilityMayHaveChangedText"></span> </div> </div> </div>'},552:function(e,exports,t){(function(i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},a=t(11),o=t(470),r=t(97),s=t(96),d=function(e){function r(n){var a=this;e.call(this),this.header.data={isCloseBtnDisplayed:!1,title:n.title},this.body.name=s.IDLE_WARNING_MODAL_BODY,i.stringTemplateEngine.instance.addTemplate(this.body.name,t(553)),this.body.data=n,this.footer={name:s.IDLE_WARNING_MODAL_FOOTER,templateEngine:i.stringTemplateEngine.instance,data:{continueBtnText:n.continueBtnText,resetIdleTimer:function(){return a._resetIdleTimer()}}},i.stringTemplateEngine.instance.addTemplate(this.footer.name,t(554)),this.dialogCss=s.IDLE_WARNING_MODAL_CLASS,this.options.backdrop="static"}return n(r,e),r.prototype._resetIdleTimer=function(){this.visible(!1),i.postbox.publish(a.RESET_IDLE_TIMER,o.Initial)},r}(r);e.exports=d}).call(exports,t(3))},553:function(e,exports){e.exports='<div class=text-center> <span data-bind="text: itLooksLikeYouHaveBeenAwayText"></span> <br/> <span data-bind="text: clickContinueToReturnText"></span> </div>'},554:function(e,exports){e.exports='<div class=text-center> <button type=button class="btn btn-primary hidden-xs" data-bind="text: continueBtnText, click: resetIdleTimer"></button> <button type=button class="btn btn-primary btn-block visible-xs-block" data-bind="text: continueBtnText, click: resetIdleTimer"></button> </div>'},555:function(e,exports,t){"use strict";var i=t(61),n=function(){function e(){}return e.LaunchChat=function(t){try{window.Intercom("boot",{app_id:t.chatAppId(),user_id:t.chatUserInfo.sessionId(),session_id:t.chatUserInfo.sessionId(),channel:t.chatUserInfo.channnel(),booking_value:t.chatUserInfo.usdBookingValue(),hotel_id:t.chatUserInfo.hotelId(),room_id:t.chatUserInfo.roomId(),member_id:t.chatUserInfo.memberId(),checkin:t.chatUserInfo.checkin(),checkout:t.chatUserInfo.checkout(),prebooking_id:t.chatUserInfo.prebookingId(),timestamp:new Date})}catch(i){e.exceptionService.logException("Intercom Chat Launch Exception","",31,31,i.stackTrace())}},e.UpdateChat=function(){window.Intercom("update")},e.CloseChat=function(){window.Intercom("shutdown")},e.exceptionService=new i,e}();e.exports=n}});
//# sourceMappingURL=landing-delayed-bundle.js.map