webpackJsonp([20],{497:function(e,exports,t){(function($){"use strict";var i=t(62),r=t(485),n=t(61),o=t(63),a=t(9),s=t(410),d=t(21),u=t(88),p=function(){function e(){this._apiEndpointService=new i,this._submitBookingResponse=new r,this._exceptionService=new n}return e.prototype.submitFirstStep=function(e,t,i,r,n,a,s,d,u,p,c,l){var m=this,g=this._apiEndpointService.create("booking/submitFirstStep"),h={customer:e,specialRequest:i,password:r,isMakingBookingForSomeoneElse:n,isSubscribedToNewsletter:a,arrivalTime:s,isPhoneNumberLoginUser:u,paymentChargeOption:p};return c&&(h.guestVisas=c),l&&(h.guestFlight=l),d&&(h.travelWithKids=d),n&&(h.leadGuest=t),$.post({method:"POST",url:g,data:h,retryMax:o.ajaxRetryTimes}).then(function(e){return m._submitBookingResponse.handleResponse(e)}).fail(function(e,t,i){m._exceptionService.goToErrorPageWithErrorCode("444")})},e.prototype.submitWithoutCreditCard=function(e,t,i,r,n,o,a,s,d,u,p){var c=this,l=this._apiEndpointService.create("booking/submitWithoutCreditCard"),m={customer:e,specialRequest:i,password:r,isMakingBookingForSomeoneElse:n,isSubscribedToNewsletter:o,isMigrateToGiftCardUser:a,arrivalTime:s,isPhoneNumberLoginUser:u,paymentChargeOption:p};return d&&(m.travelWithKids=d),n&&(m.leadGuest=t),$.post(l,m).then(function(e){return c._submitBookingResponse.handleResponse(e)}).fail(function(e,t,i){c._exceptionService.goToErrorPage()})},e.prototype.getCreditCardInfo=function(e){var t={};if($.extend(t,{cvcCode:e.cvcCode(),type:e.type()}),e.cardId&&e.cardId())$.extend(t,{cardId:e.cardId(),identificationNumber:e.identificationNumber()});else{var i=e.cardNumber();i&&(i=i.replace(/[^0-9]/g,"")),$.extend(t,{cardNumber:i,cardHolderName:e.cardHolderName(),countryIdOfIssuingBank:e.countryIdOfIssuingBank(),expiryMonth:e.expiryMonth(),expiryYear:e.expiryYear(),issuingBank:e.issuingBank(),identificationNumber:e.identificationNumber()})}if(e.type()===d.UnionPayDebitCard&&a.getFeature(u.UnionPayGen2DebitCard)||e.type()===d.UnionPayCreditCard&&a.getFeature(u.UnionPayGen2CreditCard)){var r=e.mobilePhoneCountryCode()?e.mobilePhoneCountryCode():"",n=e.mobilePhoneNumber();n=n.replace(r,"").trim(),$.extend(t,{mobilePhoneCountryCode:r,mobilePhoneNumber:n,idCardType:e.idCardType(),idCardNumber:e.idCardNumber(),idCardName:e.idCardName(),otp:e.otp()})}return e.issuingBankDetails&&$.extend(t,{issuingBankDetails:e.issuingBankDetails()}),e.installmentPlanId&&$.extend(t,{installmentPlanId:e.installmentPlanId()}),e.billingZipCode&&$.extend(t,{billingZipCode:e.billingZipCode()}),e.taxId&&e.taxId()&&$.extend(t,{taxId:e.taxId()}),e.threeDSecure2Details&&e.threeDSecure2Details()&&$.extend(t,{threeDSecure2Details:e.threeDSecure2Details()}),t},e.prototype.getAirportTransferDetail=function(e,t){if(a.getFeature("shouldShowAirportTransferPanel")&&e){var i=(new s).getAirportTransferDetail(e);$.extend(t,{airportTransferDetails:i})}},e.prototype.submitSecondStep=function(e,t,i,r,n,o,a,s,d,u,p,c,l,m){var g=this,h=this.getCreditCardInfo(e),C=this._apiEndpointService.create("booking/submitSecondStep"),b={creditCard:h,isAddCardToFile:t,paymentCurrencyCode:i,isSubscribedToNewsletter:n,isMigrateToGiftCardUser:o,isAcceptTermsAndConditions:c,isPhoneNumberLoginUser:m};return this.getAirportTransferDetail(p,b),r&&$.extend(b,{paymentChargeOption:r}),u&&s&&a&&$.extend(b,{customer:a,leadGuest:s,password:d,isMakingBookingForSomeoneElse:u}),l&&a&&$.extend(b,{customer:a}),$.post(C,b).then(function(e){return g._submitBookingResponse.handleResponse(e)}).fail(function(e,t,i){g._exceptionService.goToErrorPage()})},e.prototype.submitDuplicateBooking=function(e,t,i,r,n,o,a,s,d,u){var p=this,c=null;e&&(c=this.getCreditCardInfo(e));var l=this._apiEndpointService.create("booking/submitDuplicateBooking"),m={creditCard:c,isAddCardToFile:t,firstName:n,lastName:o,translatedFirstName:a,translatedLastName:s,password:d};return r&&$.extend(m,{paymentChargeOption:r}),this.getAirportTransferDetail(u,m),$.post(l,m).then(function(e){return p._submitBookingResponse.handleResponse(e)})},e.prototype.submitCvv=function(e,t,i){var r=this,n=this._apiEndpointService.create("booking/submitCvv"),o=null,a={cvv:t,attempts:i};return e&&(o=this.getCreditCardInfo(e),$.extend(a,{creditCard:o})),$.post(n,a).then(function(e){return r._submitBookingResponse.handleResponse(e)})},e}();e.exports=p}).call(exports,t(2))}});
//# sourceMappingURL=submit-first-step-bundle.js.map